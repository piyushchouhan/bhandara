{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Welcome to Bhandara Documentation","text":"<p>Bhandara is an Android application built with Kotlin that helps users discover and report community feasts (Bhandaras). The app uses Firebase for user tracking and notifications, with location-based features to notify nearby users.</p>"},{"location":"#quick-start","title":"Quick Start","text":"<p>To get started with the project:</p> <ol> <li>Clone the repository</li> <li>Open in Android Studio</li> <li>Sync Gradle dependencies</li> <li>Configure Firebase (see Firebase Setup)</li> <li>Run the app on an emulator or device</li> </ol>"},{"location":"#key-features","title":"Key Features","text":"<ul> <li>Anonymous User Tracking - No login required, automatic UID assignment</li> <li>Location-Based Services - GPS tracking for nearby feast notifications</li> <li>Push Notifications - FCM integration for real-time alerts</li> <li>Silent Data Collection - Background tracking of user location and tokens</li> </ul>"},{"location":"#project-structure","title":"Project Structure","text":"<pre><code>bhandara/\n\u251c\u2500\u2500 app/                    # Main application module\n\u2502   \u251c\u2500\u2500 src/\n\u2502   \u2502   \u2514\u2500\u2500 main/\n\u2502   \u2502       \u251c\u2500\u2500 java/       # Kotlin source files\n\u2502   \u2502       \u2502   \u251c\u2500\u2500 data/   # Data models &amp; repositories\n\u2502   \u2502       \u2502   \u251c\u2500\u2500 managers/ # Business logic managers\n\u2502   \u2502       \u2502   \u251c\u2500\u2500 services/ # Background services\n\u2502   \u2502       \u2502   \u251c\u2500\u2500 ui/     # UI components &amp; screens\n\u2502   \u2502       \u2502   \u2514\u2500\u2500 utils/  # Helper utilities\n\u2502   \u2502       \u2514\u2500\u2500 res/        # Resources\n\u2502   \u251c\u2500\u2500 build.gradle.kts    # App-level Gradle config\n\u2502   \u2514\u2500\u2500 google-services.json # Firebase configuration\n\u251c\u2500\u2500 gradle/                 # Gradle wrapper and dependencies\n\u251c\u2500\u2500 docs/                   # Documentation (MkDocs)\n\u2514\u2500\u2500 build.gradle.kts        # Project-level Gradle config\n</code></pre>"},{"location":"#documentation-sections","title":"Documentation Sections","text":"<ul> <li>Getting Started - Setup and installation</li> <li>Firebase Setup - User tracking, authentication &amp; notifications</li> <li>Architecture - App architecture and design</li> <li>Features - Application features</li> <li>Development - Development guidelines</li> <li>Backend Integration - API sync with PostgreSQL/PostGIS</li> <li>API Reference - Code documentation</li> </ul>"},{"location":"#commands","title":"Commands","text":"<ul> <li><code>mkdocs serve</code> - Start the live-reloading docs server</li> <li><code>mkdocs build</code> - Build the documentation site</li> <li><code>mkdocs gh-deploy</code> - Deploy to GitHub Pages</li> </ul>"},{"location":"api-reference/","title":"API Reference","text":""},{"location":"api-reference/#mainactivity","title":"MainActivity","text":"<p>Main entry point of the application.</p>"},{"location":"api-reference/#class-mainactivity","title":"Class: <code>MainActivity</code>","text":"<pre><code>class MainActivity : AppCompatActivity()\n</code></pre> <p>Main activity of the Bhandara application.</p>"},{"location":"api-reference/#methods","title":"Methods","text":""},{"location":"api-reference/#oncreate","title":"<code>onCreate()</code>","text":"<pre><code>protected fun onCreate(savedInstanceState: Bundle?)\n</code></pre> <p>Called when the activity is starting.</p> <p>Parameters: - <code>savedInstanceState</code> - If the activity is being re-initialized, this contains the data it most recently supplied</p>"},{"location":"api-reference/#components","title":"Components","text":"<p>(Document your app components here as you build them)</p>"},{"location":"api-reference/#viewmodels","title":"ViewModels","text":"<p>Document your ViewModels here.</p>"},{"location":"api-reference/#repositories","title":"Repositories","text":"<p>Document your data repositories here.</p>"},{"location":"api-reference/#services","title":"Services","text":"<p>Document your services here.</p>"},{"location":"api-reference/#utilities","title":"Utilities","text":"<p>Document utility classes and helper functions here.</p>"},{"location":"api-reference/#kdoc-generation","title":"KDoc Generation","text":"<p>To generate KDoc documentation:</p> <pre><code>./gradlew dokkaHtml\n</code></pre> <p>Generated docs will be in <code>app/build/dokka/html/</code></p>"},{"location":"architecture/","title":"Architecture","text":""},{"location":"architecture/#overview","title":"Overview","text":"<p>Bhandara follows modern Android development practices with clean architecture principles.</p>"},{"location":"architecture/#tech-stack","title":"Tech Stack","text":"<ul> <li>Language: Kotlin</li> <li>UI: Jetpack Compose</li> <li>Build System: Gradle (Kotlin DSL)</li> <li>Backend: Firebase (Auth, Firestore, FCM, Storage)</li> <li>Location: Google Play Services Location API</li> <li>Min SDK: 35</li> <li>Target SDK: 36</li> </ul>"},{"location":"architecture/#firebase-integration","title":"Firebase Integration","text":""},{"location":"architecture/#services-used","title":"Services Used","text":"<ol> <li>Firebase Authentication - Anonymous user sign-in</li> <li>Cloud Firestore - User data storage (UID, FCM token, location)</li> <li>Cloud Messaging (FCM) - Push notifications</li> <li>Cloud Storage - Future: Feast photo uploads</li> </ol>"},{"location":"architecture/#data-flow","title":"Data Flow","text":"<pre><code>User Opens App\n    \u2193\nAnonymous Auth \u2192 UID\n    \u2193\nFCM Token Generated\n    \u2193\nLocation Requested\n    \u2193\nSave to Firestore\n    \u2193\n(Future) Sync to Backend API\n</code></pre>"},{"location":"architecture/#project-structure","title":"Project Structure","text":""},{"location":"architecture/#modules","title":"Modules","text":"<ul> <li>app: Main application module containing all source code and resources</li> </ul>"},{"location":"architecture/#key-directories","title":"Key Directories","text":"<pre><code>app/src/main/\n\u251c\u2500\u2500 java/com/example/bhandara/  # Application code\n\u2502   \u251c\u2500\u2500 MainActivity.kt          # Main entry point\n\u2502   \u251c\u2500\u2500 data/                    # Data layer\n\u2502   \u2502   \u251c\u2500\u2500 models/              # Data models (User, Feast)\n\u2502   \u2502   \u2514\u2500\u2500 repository/          # Firebase operations\n\u2502   \u251c\u2500\u2500 managers/                # Business logic\n\u2502   \u2502   \u2514\u2500\u2500 UserManager.kt       # User initialization &amp; tracking\n\u2502   \u251c\u2500\u2500 services/                # Background services\n\u2502   \u2502   \u2514\u2500\u2500 BhandaraMessagingService.kt  # FCM receiver\n\u2502   \u251c\u2500\u2500 ui/                      # UI layer\n\u2502   \u2502   \u251c\u2500\u2500 components/          # Reusable components\n\u2502   \u2502   \u251c\u2500\u2500 screens/             # Screen composables\n\u2502   \u2502   \u2514\u2500\u2500 theme/               # Material theme\n\u2502   \u2514\u2500\u2500 utils/                   # Utilities\n\u2502       \u2514\u2500\u2500 LocationHelper.kt    # GPS &amp; permissions\n\u251c\u2500\u2500 res/                         # Resources\n\u2502   \u251c\u2500\u2500 layout/                  # XML layouts (legacy)\n\u2502   \u251c\u2500\u2500 values/                  # Strings, colors, themes\n\u2502   \u251c\u2500\u2500 drawable/                # Images and icons\n\u2502   \u2514\u2500\u2500 mipmap/                  # App icons\n\u2514\u2500\u2500 AndroidManifest.xml          # App manifest\n</code></pre>"},{"location":"architecture/#key-components","title":"Key Components","text":""},{"location":"architecture/#usermanager","title":"UserManager","text":"<ul> <li>Initializes anonymous users on app start</li> <li>Manages FCM token lifecycle</li> <li>Handles location updates</li> <li>Coordinates data sync to Firestore and backend</li> </ul>"},{"location":"architecture/#userrepository","title":"UserRepository","text":"<ul> <li>Firebase Authentication operations</li> <li>Firestore CRUD operations</li> <li>FCM token management</li> </ul>"},{"location":"architecture/#locationhelper","title":"LocationHelper","text":"<ul> <li>GPS location retrieval</li> <li>Permission management</li> <li>Location caching</li> </ul>"},{"location":"architecture/#bhandaramessagingservice","title":"BhandaraMessagingService","text":"<ul> <li>Receives FCM push notifications</li> <li>Displays system notifications</li> <li>Handles notification clicks</li> </ul>"},{"location":"architecture/#navigation","title":"Navigation","text":"<p>Simple enum-based navigation with back stack:</p> <pre><code>enum class Screen {\n    HOME, HUNGRY, REPORT_FEAST\n}\n</code></pre> <p>Back stack automatically manages navigation history for proper back button behavior.</p>"},{"location":"architecture/#dependencies","title":"Dependencies","text":"<p>Dependencies are managed in <code>gradle/libs.versions.toml</code> using version catalogs.</p>"},{"location":"architecture/#firebase-dependencies","title":"Firebase Dependencies","text":"<p>Added in app/build.gradle.kts:</p> <pre><code>implementation(platform(\"com.google.firebase:firebase-bom:34.7.0\"))\nimplementation(\"com.google.firebase:firebase-analytics\")\nimplementation(\"com.google.firebase:firebase-auth\")\nimplementation(\"com.google.firebase:firebase-firestore\")\nimplementation(\"com.google.firebase:firebase-storage\")\nimplementation(\"com.google.firebase:firebase-messaging\")\n</code></pre> <p>See Firebase Setup for detailed explanation of each dependency.</p>"},{"location":"architecture/#build-configuration","title":"Build Configuration","text":"<ul> <li>Project-level: <code>build.gradle.kts</code> (root)</li> <li>App-level: <code>app/build.gradle.kts</code></li> <li>Gradle properties: <code>gradle.properties</code></li> <li>Firebase config: <code>app/google-services.json</code></li> </ul>"},{"location":"architecture/#design-patterns","title":"Design Patterns","text":""},{"location":"architecture/#repository-pattern","title":"Repository Pattern","text":"<ul> <li>Separates data access from business logic</li> <li><code>UserRepository</code> handles all Firebase operations</li> <li>Makes testing easier</li> </ul>"},{"location":"architecture/#manager-pattern","title":"Manager Pattern","text":"<ul> <li><code>UserManager</code> coordinates multiple operations</li> <li>Centralizes business logic</li> <li>Reduces MainActivity complexity</li> </ul>"},{"location":"architecture/#single-responsibility","title":"Single Responsibility","text":"<ul> <li>Each class has one clear purpose</li> <li>LocationHelper only handles location</li> <li>Services only handle their specific task</li> </ul>"},{"location":"architecture/#data-flow_1","title":"Data Flow","text":""},{"location":"architecture/#user-initialization","title":"User Initialization","text":"<pre><code>MainActivity\n    \u2193\nUserManager.initializeUser()\n    \u2193\nUserRepository.signInAnonymously() \u2192 Firebase Auth\n    \u2193\nUserRepository.getFcmToken() \u2192 Firebase Messaging\n    \u2193\nUserRepository.saveUser() \u2192 Firestore\n    \u2193\nLocationHelper.getCurrentLocation() \u2192 Play Services\n    \u2193\nUserRepository.updateUserLocation() \u2192 Firestore\n</code></pre>"},{"location":"architecture/#notification-flow","title":"Notification Flow","text":"<pre><code>Backend API\n    \u2193\nFirebase Cloud Messaging\n    \u2193\nBhandaraMessagingService.onMessageReceived()\n    \u2193\nCreate Notification\n    \u2193\nSystem Notification Tray\n    \u2193\nUser clicks \u2192 Opens MainActivity\n</code></pre>"},{"location":"architecture/#future-architecture","title":"Future Architecture","text":""},{"location":"architecture/#backend-integration","title":"Backend Integration","text":"<ul> <li>API calls via Retrofit</li> <li>PostgreSQL + PostGIS for geo queries</li> <li>Backend sends FCM notifications</li> </ul> <p>See Backend Integration for implementation details.</p>"},{"location":"backend-integration/","title":"Backend Integration TODO","text":""},{"location":"backend-integration/#user-data-sync","title":"User Data Sync","text":""},{"location":"backend-integration/#required-api-endpoint","title":"Required API Endpoint","text":"<pre><code>POST /api/users/update\n</code></pre>"},{"location":"backend-integration/#request-payload","title":"Request Payload","text":"<pre><code>{\n  \"uid\": \"firebase-anonymous-uid\",\n  \"fcmToken\": \"fcm-device-token\",\n  \"latitude\": 18.5823749,\n  \"longitude\": 73.8844745,\n  \"timestamp\": 1704045600000\n}\n</code></pre>"},{"location":"backend-integration/#implementation-steps","title":"Implementation Steps","text":"<ol> <li> <p>Add Retrofit dependency to <code>app/build.gradle.kts</code>:    <pre><code>implementation(\"com.squareup.retrofit2:retrofit:2.9.0\")\nimplementation(\"com.squareup.retrofit2:converter-gson:2.9.0\")\nimplementation(\"com.squareup.okhttp3:logging-interceptor:4.12.0\")\n</code></pre></p> </li> <li> <p>Create API service in <code>data/api/</code>:    <pre><code>interface BhandaraApiService {\n    @POST(\"users/update\")\n    suspend fun updateUser(@Body request: UserUpdateRequest): Response&lt;Unit&gt;\n}\n</code></pre></p> </li> <li> <p>Create request/response models in <code>data/models/</code>:    <pre><code>data class UserUpdateRequest(\n    val uid: String,\n    val fcmToken: String?,\n    val latitude: Double?,\n    val longitude: Double?,\n    val timestamp: Long = System.currentTimeMillis()\n)\n</code></pre></p> </li> <li> <p>Implement API client in <code>data/api/</code>:    <pre><code>object ApiClient {\n    private const val BASE_URL = \"https://your-backend.com/api/\"\n\n    val instance: BhandaraApiService by lazy {\n        Retrofit.Builder()\n            .baseUrl(BASE_URL)\n            .addConverterFactory(GsonConverterFactory.create())\n            .build()\n            .create(BhandaraApiService::class.java)\n    }\n}\n</code></pre></p> </li> <li> <p>Update UserManager.kt:</p> </li> <li>Uncomment <code>sendUserDataToBackend()</code> calls</li> <li>Implement the function to call API</li> <li>Handle errors and retries</li> </ol>"},{"location":"backend-integration/#backend-database-schema-postgresql-postgis","title":"Backend Database Schema (PostgreSQL + PostGIS)","text":"<pre><code>CREATE EXTENSION postgis;\n\nCREATE TABLE users (\n    uid VARCHAR(128) PRIMARY KEY,\n    fcm_token VARCHAR(512) NOT NULL,\n    location GEOGRAPHY(POINT, 4326),\n    last_active TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    CONSTRAINT valid_location CHECK (\n        ST_X(location::geometry) BETWEEN -180 AND 180 AND\n        ST_Y(location::geometry) BETWEEN -90 AND 90\n    )\n);\n\nCREATE INDEX idx_users_location ON users USING GIST (location);\nCREATE INDEX idx_users_last_active ON users (last_active);\n</code></pre>"},{"location":"backend-integration/#backend-api-implementation-example-fastapi","title":"Backend API Implementation Example (FastAPI)","text":"<pre><code>from fastapi import FastAPI, HTTPException\nfrom pydantic import BaseModel\nfrom geoalchemy2 import Geography\nfrom sqlalchemy import create_engine\nfrom datetime import datetime\n\napp = FastAPI()\n\nclass UserUpdateRequest(BaseModel):\n    uid: str\n    fcmToken: str | None\n    latitude: float | None\n    longitude: float | None\n    timestamp: int\n\n@app.post(\"/api/users/update\")\nasync def update_user(request: UserUpdateRequest):\n    # Upsert user data\n    query = \"\"\"\n        INSERT INTO users (uid, fcm_token, location, last_active)\n        VALUES (:uid, :fcm_token, \n                ST_SetSRID(ST_MakePoint(:lon, :lat), 4326)::geography,\n                :last_active)\n        ON CONFLICT (uid) \n        DO UPDATE SET\n            fcm_token = COALESCE(:fcm_token, users.fcm_token),\n            location = CASE \n                WHEN :lat IS NOT NULL AND :lon IS NOT NULL \n                THEN ST_SetSRID(ST_MakePoint(:lon, :lat), 4326)::geography\n                ELSE users.location\n            END,\n            last_active = :last_active\n    \"\"\"\n\n    # Execute query\n    return {\"status\": \"success\"}\n</code></pre>"},{"location":"backend-integration/#testing","title":"Testing","text":"<ol> <li>Start backend server</li> <li>Update <code>BASE_URL</code> in ApiClient</li> <li>Run app on emulator</li> <li>Check backend logs for incoming requests</li> <li>Verify data in PostgreSQL:    <pre><code>SELECT uid, fcm_token, \n       ST_X(location::geometry) as longitude,\n       ST_Y(location::geometry) as latitude,\n       last_active\nFROM users;\n</code></pre></li> </ol>"},{"location":"backend-integration/#notes","title":"Notes","text":"<ul> <li>Error handling: Implement retry logic for failed API calls</li> <li>Offline support: Queue updates locally if network unavailable</li> <li>Privacy: Implement data retention policies</li> <li>Security: Use HTTPS and API authentication tokens</li> </ul>"},{"location":"development/","title":"Development Guide","text":""},{"location":"development/#development-environment","title":"Development Environment","text":""},{"location":"development/#required-tools","title":"Required Tools","text":"<ul> <li>Android Studio (Arctic Fox or newer)</li> <li>JDK 11+</li> <li>Git</li> <li>Android SDK</li> </ul>"},{"location":"development/#coding-standards","title":"Coding Standards","text":""},{"location":"development/#kotlin-style-guide","title":"Kotlin Style Guide","text":"<p>Follow the official Kotlin coding conventions.</p>"},{"location":"development/#file-organization","title":"File Organization","text":"<ul> <li>One class per file</li> <li>Keep files under 300 lines when possible</li> <li>Group related functionality</li> </ul>"},{"location":"development/#naming-conventions","title":"Naming Conventions","text":"<ul> <li>Classes: PascalCase (<code>MainActivity</code>, <code>UserViewModel</code>)</li> <li>Functions: camelCase (<code>onCreate()</code>, <code>getUserData()</code>)</li> <li>Constants: UPPER_SNAKE_CASE (<code>MAX_COUNT</code>, <code>API_KEY</code>)</li> <li>Variables: camelCase (<code>userName</code>, <code>itemCount</code>)</li> </ul>"},{"location":"development/#git-workflow","title":"Git Workflow","text":""},{"location":"development/#branch-naming","title":"Branch Naming","text":"<ul> <li><code>feature/feature-name</code> - New features</li> <li><code>bugfix/bug-description</code> - Bug fixes</li> <li><code>hotfix/critical-issue</code> - Urgent fixes</li> <li><code>refactor/component-name</code> - Code refactoring</li> </ul>"},{"location":"development/#commit-messages","title":"Commit Messages","text":"<p>Follow conventional commits:</p> <pre><code>feat: add user authentication\nfix: resolve crash on startup\ndocs: update README\nrefactor: simplify data layer\n</code></pre>"},{"location":"development/#building-the-project","title":"Building the Project","text":""},{"location":"development/#debug-build","title":"Debug Build","text":"<pre><code>./gradlew assembleDebug\n</code></pre>"},{"location":"development/#release-build","title":"Release Build","text":"<pre><code>./gradlew assembleRelease\n</code></pre>"},{"location":"development/#testing","title":"Testing","text":""},{"location":"development/#running-tests","title":"Running Tests","text":"<pre><code># Unit tests\n./gradlew test\n\n# Instrumented tests\n./gradlew connectedAndroidTest\n</code></pre>"},{"location":"development/#code-review","title":"Code Review","text":"<ul> <li>All changes require a pull request</li> <li>At least one approval required</li> <li>CI checks must pass</li> </ul>"},{"location":"development/#documentation","title":"Documentation","text":"<ul> <li>Document public APIs with KDoc</li> <li>Update this documentation when adding features</li> <li>Keep README.md up to date</li> </ul>"},{"location":"features/","title":"Features","text":""},{"location":"features/#current-features","title":"Current Features","text":"<p>(Document your app's features here)</p>"},{"location":"features/#feature-1","title":"Feature 1","text":"<p>Description of feature 1.</p>"},{"location":"features/#feature-2","title":"Feature 2","text":"<p>Description of feature 2.</p>"},{"location":"features/#planned-features","title":"Planned Features","text":"<ul> <li>[ ] Feature A</li> <li>[ ] Feature B</li> <li>[ ] Feature C</li> </ul>"},{"location":"features/#screenshots","title":"Screenshots","text":"<p>(Add screenshots of your app here)</p>"},{"location":"features/#user-guide","title":"User Guide","text":""},{"location":"features/#how-to-use-feature-1","title":"How to use Feature 1","text":"<ol> <li>Step 1</li> <li>Step 2</li> <li>Step 3</li> </ol>"},{"location":"features/#how-to-use-feature-2","title":"How to use Feature 2","text":"<ol> <li>Step 1</li> <li>Step 2</li> <li>Step 3</li> </ol>"},{"location":"firebase-setup/","title":"Firebase Setup &amp; User Tracking","text":"<p>This guide explains how the app implements silent user tracking using Firebase Anonymous Authentication, Cloud Messaging (FCM), and location services.</p>"},{"location":"firebase-setup/#overview","title":"Overview","text":"<p>The app automatically tracks users without any login or signup. When a user installs and opens the app:</p> <ol> <li>Anonymous Authentication - Assigns a permanent UID</li> <li>FCM Token - Enables push notifications</li> <li>Location Tracking - Gets user's current location</li> <li>Data Storage - Saves to Firebase Firestore</li> </ol> <p>All of this happens silently in the background without user interaction.</p>"},{"location":"firebase-setup/#architecture","title":"Architecture","text":"<pre><code>App Launch\n    \u2193\nUserManager.initializeUser()\n    \u2193\nFirebase Anonymous Auth \u2192 UID\n    \u2193\nFirebase Messaging \u2192 FCM Token\n    \u2193\nSave to Firestore (uid, fcmToken)\n    \u2193\nRequest Location Permissions\n    \u2193\nGet Location \u2192 Update Firestore\n</code></pre>"},{"location":"firebase-setup/#implementation-details","title":"Implementation Details","text":""},{"location":"firebase-setup/#1-firebase-dependencies","title":"1. Firebase Dependencies","text":"<p>Added to app/build.gradle.kts:</p> <pre><code>// Firebase - Import the BoM\nimplementation(platform(\"com.google.firebase:firebase-bom:34.7.0\"))\n\n// Firebase products\nimplementation(\"com.google.firebase:firebase-analytics\")\nimplementation(\"com.google.firebase:firebase-auth\")           // Anonymous auth\nimplementation(\"com.google.firebase:firebase-firestore\")      // User data storage\nimplementation(\"com.google.firebase:firebase-storage\")        // Photo storage\nimplementation(\"com.google.firebase:firebase-messaging\")      // Push notifications\n\n// Google Play Services for Location\nimplementation(\"com.google.android.gms:play-services-location:21.3.0\")\n\n// Coil for image loading\nimplementation(\"io.coil-kt:coil-compose:2.5.0\")\n</code></pre> <p>Why each dependency: - firebase-auth: Anonymous user authentication - firebase-firestore: Store user data (UID, FCM token, location) - firebase-storage: Future use for feast photos - firebase-messaging: Receive push notifications - play-services-location: Get user's GPS location - coil: Load images efficiently in Compose</p>"},{"location":"firebase-setup/#2-android-manifest-permissions","title":"2. Android Manifest Permissions","text":"<p>Added to AndroidManifest.xml:</p> <pre><code>&lt;!-- Internet permission for Firebase --&gt;\n&lt;uses-permission android:name=\"android.permission.INTERNET\" /&gt;\n\n&lt;!-- Location permissions for tracking user location --&gt;\n&lt;uses-permission android:name=\"android.permission.ACCESS_FINE_LOCATION\" /&gt;\n&lt;uses-permission android:name=\"android.permission.ACCESS_COARSE_LOCATION\" /&gt;\n\n&lt;!-- Notification permission (Android 13+) --&gt;\n&lt;uses-permission android:name=\"android.permission.POST_NOTIFICATIONS\" /&gt;\n</code></pre> <p>Why each permission: - INTERNET: Firebase requires network access - ACCESS_FINE_LOCATION: Get precise GPS coordinates - ACCESS_COARSE_LOCATION: Fallback for approximate location - POST_NOTIFICATIONS: Required for Android 13+ to show notifications</p>"},{"location":"firebase-setup/#3-firebase-cloud-messaging-service","title":"3. Firebase Cloud Messaging Service","text":"<p>Added BhandaraMessagingService.kt:</p> <pre><code>&lt;!-- In AndroidManifest.xml --&gt;\n&lt;service\n    android:name=\".services.BhandaraMessagingService\"\n    android:exported=\"false\"&gt;\n    &lt;intent-filter&gt;\n        &lt;action android:name=\"com.google.firebase.MESSAGING_EVENT\" /&gt;\n    &lt;/intent-filter&gt;\n&lt;/service&gt;\n</code></pre> <p>Purpose: - Receives push notifications from Firebase - Displays notifications in system tray - Handles notification clicks to open the app</p> <p>How it works: 1. Backend sends FCM notification 2. Firebase delivers to device 3. Service receives message 4. Creates and displays notification</p>"},{"location":"firebase-setup/#components","title":"Components","text":""},{"location":"firebase-setup/#usermanager","title":"UserManager","text":"<p>Location: UserManager.kt</p> <p>Responsible for: - Initializing anonymous users - Managing FCM tokens - Updating user locations - (Future) Syncing data to backend API</p> <p>Key Methods: - <code>initializeUser()</code>: Signs in anonymously and saves to Firestore - <code>updateUserLocation()</code>: Gets GPS and updates Firestore</p>"},{"location":"firebase-setup/#userrepository","title":"UserRepository","text":"<p>Location: UserRepository.kt</p> <p>Handles Firebase operations: - <code>signInAnonymously()</code>: Creates anonymous Firebase user - <code>getFcmToken()</code>: Retrieves FCM device token - <code>saveUser()</code>: Saves user data to Firestore - <code>updateUserLocation()</code>: Updates location in Firestore</p>"},{"location":"firebase-setup/#locationhelper","title":"LocationHelper","text":"<p>Location: LocationHelper.kt</p> <p>Manages location services: - <code>hasLocationPermissions()</code>: Checks if permissions granted - <code>getCurrentLocation()</code>: Gets precise GPS coordinates - <code>getLastKnownLocation()</code>: Gets cached location (faster)</p>"},{"location":"firebase-setup/#data-models","title":"Data Models","text":"<p>User Model - User.kt:</p> <pre><code>data class User(\n    val uid: String = \"\",\n    val fcmToken: String = \"\",\n    val location: GeoPoint? = null,\n    val createdAt: Long = System.currentTimeMillis(),\n    val lastActive: Long = System.currentTimeMillis()\n)\n</code></pre>"},{"location":"firebase-setup/#user-flow","title":"User Flow","text":""},{"location":"firebase-setup/#first-app-launch","title":"First App Launch","text":"<ol> <li>App Opens \u2192 <code>MainActivity.onCreate()</code></li> <li>UserManager Initialized \u2192 Creates UserManager instance</li> <li> <p>initializeUser() Called:    <pre><code>// Step 1: Anonymous sign in\nval uid = userRepository.signInAnonymously() // e.g., \"abc123def456\"\n\n// Step 2: Get FCM token\nval fcmToken = userRepository.getFcmToken() // e.g., \"fcm_device_token_...\"\n\n// Step 3: Save to Firestore\nuserRepository.saveUser(uid, fcmToken)\n</code></pre></p> </li> <li> <p>Permissions Requested \u2192 Location and notifications</p> </li> <li>Location Updated (if granted):    <pre><code>val location = locationHelper.getCurrentLocation()\nuserRepository.updateUserLocation(uid, location)\n</code></pre></li> </ol>"},{"location":"firebase-setup/#subsequent-app-launches","title":"Subsequent App Launches","text":"<ol> <li>App Opens</li> <li>Existing User Check \u2192 Firebase recognizes returning user</li> <li>Same UID Used \u2192 No new user created</li> <li>FCM Token Verified \u2192 Updated if changed</li> <li>Location Updated \u2192 Fresh GPS coordinates</li> </ol>"},{"location":"firebase-setup/#firebase-console-verification","title":"Firebase Console Verification","text":""},{"location":"firebase-setup/#authentication","title":"Authentication","text":"<ol> <li>Go to Firebase Console</li> <li>Select \"bhandara\" project</li> <li>Navigate to Authentication \u2192 Users</li> <li>See anonymous users with UID</li> </ol>"},{"location":"firebase-setup/#firestore-database","title":"Firestore Database","text":"<ol> <li>In Firebase Console</li> <li>Navigate to Firestore Database</li> <li>Open users collection</li> <li>View documents with structure:    <pre><code>users/\n  {uid}/\n    - uid: \"abc123def456\"\n    - fcmToken: \"fcm_token_...\"\n    - location: GeoPoint(18.5823749, 73.8844745)\n    - createdAt: 1704045600000\n    - lastActive: 1704045600000\n</code></pre></li> </ol>"},{"location":"firebase-setup/#cloud-messaging","title":"Cloud Messaging","text":"<ol> <li>In Firebase Console</li> <li>Navigate to Cloud Messaging</li> <li>View registered FCM tokens</li> <li>Test notifications from console</li> </ol>"},{"location":"firebase-setup/#debugging","title":"Debugging","text":""},{"location":"firebase-setup/#logcat-tags","title":"LogCat Tags","text":"<p>Monitor these tags in Android Studio Logcat:</p> <ul> <li><code>UserManager</code>: User initialization flow</li> <li><code>UserRepository</code>: Firebase operations</li> <li><code>LocationHelper</code>: Location updates</li> <li><code>BhandaraMessaging</code>: Notification handling</li> </ul>"},{"location":"firebase-setup/#expected-log-sequence","title":"Expected Log Sequence","text":"<pre><code>UserManager: User signed in with UID: abc123def456\nUserManager: FCM token obtained\nUserRepository: User data saved successfully\nUserManager: User saved to Firestore\nLocationHelper: Location obtained: 18.5823749, 73.8844745\nUserRepository: User location updated\nUserManager: User location updated in Firestore\n</code></pre>"},{"location":"firebase-setup/#common-issues","title":"Common Issues","text":""},{"location":"firebase-setup/#location-not-updating","title":"Location Not Updating","text":"<p>Problem: Location stays null in Firestore</p> <p>Solutions: - Check permissions granted - Ensure emulator has location set (Extended Controls \u2192 Location) - Use device with GPS instead of emulator - Check Play Services installed on emulator</p>"},{"location":"firebase-setup/#fcm-token-not-generated","title":"FCM Token Not Generated","text":"<p>Problem: fcmToken is empty</p> <p>Solutions: - Use emulator with Google Play (not just Google APIs) - Check <code>google-services.json</code> is valid - Verify internet connection - Restart app</p>"},{"location":"firebase-setup/#anonymous-user-not-created","title":"Anonymous User Not Created","text":"<p>Problem: UID is null</p> <p>Solutions: - Check Firebase Authentication is enabled - Verify <code>google-services.json</code> configuration - Enable Anonymous sign-in in Firebase Console</p>"},{"location":"firebase-setup/#security-considerations","title":"Security Considerations","text":""},{"location":"firebase-setup/#anonymous-auth-limitations","title":"Anonymous Auth Limitations","text":"<ul> <li>Device-specific: UID tied to app installation</li> <li>Non-recoverable: Uninstall = new user</li> <li>No cross-device: Can't sync across devices</li> </ul>"},{"location":"firebase-setup/#privacy","title":"Privacy","text":"<ul> <li>No personal information collected</li> <li>Only: UID, FCM token, location</li> <li>Users can't be identified</li> <li>Complies with anonymous usage</li> </ul>"},{"location":"firebase-setup/#data-retention","title":"Data Retention","text":"<p>Consider implementing: - Remove users inactive for 90+ days - Clear location data older than 30 days - GDPR compliance for EU users</p>"},{"location":"firebase-setup/#next-steps","title":"Next Steps","text":"<p>See Backend Integration for: - Syncing user data to PostgreSQL/PostGIS - Implementing backend API calls - Querying nearby users - Sending targeted notifications</p>"},{"location":"firebase-setup/#related-documentation","title":"Related Documentation","text":"<ul> <li>Getting Started - Initial setup</li> <li>Architecture - Overall app structure</li> <li>Backend Integration - API implementation</li> <li>Development Guide - Best practices</li> </ul>"},{"location":"getting-started/","title":"Getting Started","text":""},{"location":"getting-started/#prerequisites","title":"Prerequisites","text":"<ul> <li>Android Studio (latest version)</li> <li>JDK 11 or higher</li> <li>Android SDK</li> <li>Git</li> </ul>"},{"location":"getting-started/#installation","title":"Installation","text":""},{"location":"getting-started/#1-clone-the-repository","title":"1. Clone the Repository","text":"<pre><code>git clone https://github.com/piyushchouhan/bhandara.git\ncd bhandara\n</code></pre>"},{"location":"getting-started/#2-open-in-android-studio","title":"2. Open in Android Studio","text":"<ol> <li>Launch Android Studio</li> <li>Select \"Open an Existing Project\"</li> <li>Navigate to the cloned repository</li> <li>Click \"OK\"</li> </ol>"},{"location":"getting-started/#3-sync-gradle","title":"3. Sync Gradle","text":"<p>Android Studio will automatically sync Gradle. If not:</p> <ol> <li>Click on \"File\" \u2192 \"Sync Project with Gradle Files\"</li> <li>Wait for the sync to complete</li> </ol>"},{"location":"getting-started/#4-run-the-application","title":"4. Run the Application","text":"<ol> <li>Connect an Android device or start an emulator</li> <li>Click the \"Run\" button (\u25b6\ufe0f) in Android Studio</li> <li>Select your target device</li> <li>Wait for the app to build and install</li> </ol>"},{"location":"getting-started/#configuration","title":"Configuration","text":""},{"location":"getting-started/#google-services","title":"Google Services","text":"<p>The project uses Firebase. Ensure you have:</p> <ul> <li>Valid <code>google-services.json</code> in the <code>app/</code> directory</li> <li>Firebase project configured properly</li> </ul>"},{"location":"getting-started/#local-properties","title":"Local Properties","text":"<p>Check <code>local.properties</code> for SDK paths:</p> <pre><code>sdk.dir=/path/to/Android/sdk\n</code></pre>"},{"location":"getting-started/#troubleshooting","title":"Troubleshooting","text":""},{"location":"getting-started/#build-failures","title":"Build Failures","text":"<ul> <li>Clean the project: <code>Build \u2192 Clean Project</code></li> <li>Rebuild: <code>Build \u2192 Rebuild Project</code></li> <li>Invalidate caches: <code>File \u2192 Invalidate Caches / Restart</code></li> </ul>"},{"location":"getting-started/#gradle-issues","title":"Gradle Issues","text":"<pre><code>./gradlew clean\n./gradlew build\n</code></pre>"}]}