{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Welcome to Bhandara Documentation","text":"<p>Bhandara is an Android application built with Kotlin that helps users discover and report community feasts (Bhandaras). The app uses Firebase for user tracking and notifications, with location-based features to notify nearby users.</p>"},{"location":"#quick-start","title":"Quick Start","text":"<p>To get started with the project:</p> <ol> <li>Clone the repository</li> <li>Open in Android Studio</li> <li>Sync Gradle dependencies</li> <li>Configure Firebase (see Firebase Setup)</li> <li>Run the app on an emulator or device</li> </ol>"},{"location":"#key-features","title":"Key Features","text":"<ul> <li>Anonymous User Tracking - No login required, automatic UID assignment</li> <li>Location-Based Services - GPS tracking for nearby feast notifications</li> <li>Push Notifications - FCM integration for real-time alerts</li> <li>Silent Data Collection - Background tracking of user location and tokens</li> </ul>"},{"location":"#project-structure","title":"Project Structure","text":"<pre><code>bhandara/\n\u251c\u2500\u2500 app/                    # Main application module\n\u2502   \u251c\u2500\u2500 src/\n\u2502   \u2502   \u2514\u2500\u2500 main/\n\u2502   \u2502       \u251c\u2500\u2500 java/       # Kotlin source files\n\u2502   \u2502       \u2502   \u251c\u2500\u2500 data/   # Data models &amp; repositories\n\u2502   \u2502       \u2502   \u251c\u2500\u2500 managers/ # Business logic managers\n\u2502   \u2502       \u2502   \u251c\u2500\u2500 services/ # Background services\n\u2502   \u2502       \u2502   \u251c\u2500\u2500 ui/     # UI components &amp; screens\n\u2502   \u2502       \u2502   \u2514\u2500\u2500 utils/  # Helper utilities\n\u2502   \u2502       \u2514\u2500\u2500 res/        # Resources\n\u2502   \u251c\u2500\u2500 build.gradle.kts    # App-level Gradle config\n\u2502   \u2514\u2500\u2500 google-services.json # Firebase configuration\n\u251c\u2500\u2500 gradle/                 # Gradle wrapper and dependencies\n\u251c\u2500\u2500 docs/                   # Documentation (MkDocs)\n\u2514\u2500\u2500 build.gradle.kts        # Project-level Gradle config\n</code></pre>"},{"location":"#documentation-sections","title":"Documentation Sections","text":"<ul> <li>Getting Started - Setup and installation</li> <li>Firebase Setup - User tracking, authentication &amp; notifications</li> <li>Architecture - App architecture and design</li> <li>Features - Application features</li> <li>Development - Development guidelines</li> <li>Backend Integration - API sync with PostgreSQL/PostGIS</li> <li>API Reference - Code documentation</li> </ul>"},{"location":"#commands","title":"Commands","text":"<ul> <li><code>mkdocs serve</code> - Start the live-reloading docs server</li> <li><code>mkdocs build</code> - Build the documentation site</li> <li><code>mkdocs gh-deploy</code> - Deploy to GitHub Pages</li> </ul>"},{"location":"api-reference/","title":"API Reference","text":""},{"location":"api-reference/#mainactivity","title":"MainActivity","text":"<p>Main entry point of the application.</p>"},{"location":"api-reference/#class-mainactivity","title":"Class: <code>MainActivity</code>","text":"<pre><code>class MainActivity : AppCompatActivity()\n</code></pre> <p>Main activity of the Bhandara application.</p>"},{"location":"api-reference/#methods","title":"Methods","text":""},{"location":"api-reference/#oncreate","title":"<code>onCreate()</code>","text":"<pre><code>protected fun onCreate(savedInstanceState: Bundle?)\n</code></pre> <p>Called when the activity is starting.</p> <p>Parameters: - <code>savedInstanceState</code> - If the activity is being re-initialized, this contains the data it most recently supplied</p>"},{"location":"api-reference/#components","title":"Components","text":"<p>(Document your app components here as you build them)</p>"},{"location":"api-reference/#viewmodels","title":"ViewModels","text":"<p>Document your ViewModels here.</p>"},{"location":"api-reference/#repositories","title":"Repositories","text":"<p>Document your data repositories here.</p>"},{"location":"api-reference/#services","title":"Services","text":"<p>Document your services here.</p>"},{"location":"api-reference/#utilities","title":"Utilities","text":"<p>Document utility classes and helper functions here.</p>"},{"location":"api-reference/#kdoc-generation","title":"KDoc Generation","text":"<p>To generate KDoc documentation:</p> <pre><code>./gradlew dokkaHtml\n</code></pre> <p>Generated docs will be in <code>app/build/dokka/html/</code></p>"},{"location":"architecture/","title":"Architecture","text":""},{"location":"architecture/#overview","title":"Overview","text":"<p>Bhandara follows modern Android development practices with clean architecture principles.</p>"},{"location":"architecture/#tech-stack","title":"Tech Stack","text":"<ul> <li>Language: Kotlin</li> <li>UI: Jetpack Compose</li> <li>Build System: Gradle (Kotlin DSL)</li> <li>Backend: </li> <li>Firebase (Auth, Firestore, FCM, Storage)</li> <li>Custom REST API (Retrofit + OkHttp)</li> <li>Background Jobs: WorkManager</li> <li>Maps: Google Maps SDK for Android (Maps Compose)</li> <li>Location: Google Play Services Location API</li> <li>Min SDK: 35</li> <li>Target SDK: 36</li> </ul>"},{"location":"architecture/#firebase-integration","title":"Firebase Integration","text":""},{"location":"architecture/#services-used","title":"Services Used","text":"<ol> <li>Firebase Authentication - Anonymous user sign-in</li> <li>Cloud Firestore - User data storage (UID, FCM token, location)</li> <li>Cloud Messaging (FCM) - Push notifications</li> <li>Cloud Storage - Feast photo uploads</li> </ol>"},{"location":"architecture/#data-flow","title":"Data Flow","text":"<pre><code>User Opens App\n    \u2193\nAnonymous Auth \u2192 UID\n    \u2193\nFCM Token Generated\n    \u2193\nLocation Requested\n    \u2193\nSave to Backend API &amp; Firestore\n</code></pre>"},{"location":"architecture/#project-structure","title":"Project Structure","text":""},{"location":"architecture/#modules","title":"Modules","text":"<ul> <li>app: Main application module containing all source code and resources</li> </ul>"},{"location":"architecture/#key-directories","title":"Key Directories","text":"<pre><code>app/src/main/\n\u251c\u2500\u2500 java/com/example/bhandara/  # Application code\n\u2502   \u251c\u2500\u2500 MainActivity.kt          # Main entry point\n\u2502   \u251c\u2500\u2500 data/                    # Data layer\n\u2502   \u2502   \u251c\u2500\u2500 api/                 # Retrofit services &amp; interceptors\n\u2502   \u2502   \u251c\u2500\u2500 models/              # Data models (User, Feast, API)\n\u2502   \u2502   \u2514\u2500\u2500 repository/          # Data access repositories\n\u2502   \u251c\u2500\u2500 managers/                # Business logic\n\u2502   \u2502   \u2514\u2500\u2500 UserManager.kt       # User initialization, tracking &amp; sync\n\u2502   \u251c\u2500\u2500 services/                # Background services\n\u2502   \u2502   \u2514\u2500\u2500 BhandaraMessagingService.kt  # FCM receiver\n\u2502   \u251c\u2500\u2500 workers/                 # Background workers\n\u2502   \u2502   \u2514\u2500\u2500 LocationUpdateWorker.kt # Periodic location sync\n\u2502   \u251c\u2500\u2500 ui/                      # UI layer\n\u2502   \u2502   \u251c\u2500\u2500 components/          # Reusable components\n\u2502   \u2502   \u251c\u2500\u2500 screens/             # Screen composables\n\u2502   \u2502   \u2514\u2500\u2500 theme/               # Material theme\n\u2502   \u2514\u2500\u2500 utils/                   # Utilities\n\u2502       \u2514\u2500\u2500 LocationHelper.kt    # GPS &amp; permissions\n\u251c\u2500\u2500 res/                         # Resources\n\u2502   \u251c\u2500\u2500 layout/                  # XML layouts (legacy)\n\u2502   \u251c\u2500\u2500 values/                  # Strings, colors, themes\n\u2502   \u251c\u2500\u2500 drawable/                # Images and icons\n\u2502   \u2514\u2500\u2500 mipmap/                  # App icons\n\u2514\u2500\u2500 AndroidManifest.xml          # App manifest\n</code></pre>"},{"location":"architecture/#key-components","title":"Key Components","text":""},{"location":"architecture/#usermanager","title":"UserManager","text":"<ul> <li>Initializes anonymous users on app start</li> <li>Manages FCM token lifecycle</li> <li>Coordinates manual and background location updates</li> <li>Syncs user data to Backend API</li> </ul>"},{"location":"architecture/#backendrepository","title":"BackendRepository","text":"<ul> <li>Handles communication with the REST API</li> <li>Endpoints for creating users, updating location, and managing feasts</li> </ul>"},{"location":"architecture/#locationupdateworker","title":"LocationUpdateWorker","text":"<ul> <li>Periodic background task (WorkManager)</li> <li>Updates user location to backend every 15 minutes when app is in background</li> </ul>"},{"location":"architecture/#locationhelper","title":"LocationHelper","text":"<ul> <li>GPS location retrieval</li> <li>Permission management</li> <li>Location caching</li> </ul>"},{"location":"architecture/#bhandaramessagingservice","title":"BhandaraMessagingService","text":"<ul> <li>Receives FCM push notifications</li> <li>Displays system notifications</li> <li>Handles notification clicks</li> </ul>"},{"location":"architecture/#navigation","title":"Navigation","text":"<p>Simple enum-based navigation with back stack:</p> <pre><code>enum class Screen {\n    HOME, HUNGRY, REPORT_BHANDARA\n}\n</code></pre> <p>Back stack automatically manages navigation history for proper back button behavior.</p>"},{"location":"architecture/#dependencies","title":"Dependencies","text":"<p>Dependencies are managed in <code>gradle/libs.versions.toml</code> using version catalogs.</p>"},{"location":"architecture/#key-libraries","title":"Key Libraries","text":"<ul> <li>Firebase BOM: 34.7.0 (Auth, Firestore, Messaging, Storage)</li> <li>Retrofit: 2.11.0 (Networking)</li> <li>WorkManager: 2.9.0 (Background jobs)</li> <li>Maps Compose: 4.3.3 (Map UI)</li> <li>Coil: Image loading</li> </ul> <p>See Firebase Setup for detailed explanation of each dependency.</p>"},{"location":"architecture/#build-configuration","title":"Build Configuration","text":"<ul> <li>Project-level: <code>build.gradle.kts</code> (root)</li> <li>App-level: <code>app/build.gradle.kts</code></li> <li>Gradle properties: <code>gradle.properties</code></li> <li>Firebase config: <code>app/google-services.json</code></li> </ul>"},{"location":"architecture/#design-patterns","title":"Design Patterns","text":""},{"location":"architecture/#repository-pattern","title":"Repository Pattern","text":"<ul> <li>Separates data access from business logic</li> <li><code>BackendRepository</code> handles API operations</li> <li><code>UserRepository</code> handles Firebase operations</li> </ul>"},{"location":"architecture/#manager-pattern","title":"Manager Pattern","text":"<ul> <li><code>UserManager</code> coordinates multiple operations</li> <li>Centralizes business logic</li> <li>Reduces MainActivity complexity</li> </ul>"},{"location":"architecture/#data-flow_1","title":"Data Flow","text":""},{"location":"architecture/#user-initialization","title":"User Initialization","text":"<pre><code>MainActivity\n    \u2193\nUserManager.initializeUser()\n    \u2193\nUserRepository.signInAnonymously() \u2192 Firebase Auth\n    \u2193\nUserRepository.getFcmToken() \u2192 Firebase Messaging\n    \u2193\nUserManager.updateUserLocation()\n    \u2193\nBackendRepository.createUser() \u2192 API\n</code></pre>"},{"location":"architecture/#notification-flow","title":"Notification Flow","text":"<pre><code>Backend API\n    \u2193\nFirebase Cloud Messaging\n    \u2193\nBhandaraMessagingService.onMessageReceived()\n    \u2193\nCreate Notification\n    \u2193\nSystem Notification Tray\n    \u2193\nUser clicks \u2192 Opens MainActivity\n</code></pre>"},{"location":"architecture/#future-architecture","title":"Future Architecture","text":"<ul> <li>Offline Support: Local Room database for caching feasts</li> <li>Social Features: Comments and ratings for bhandaras</li> <li>Improved Maps: Clustering and route navigation</li> </ul>"},{"location":"backend-integration/","title":"Backend Integration","text":""},{"location":"backend-integration/#overview","title":"Overview","text":"<p>The application communicates with a backend REST API to handle user synchronization, location updates, and bhandara (feast) management. The networking layer is built using Retrofit and OkHttp, ensuring robust data exchange with proper authentication and error handling.</p>"},{"location":"backend-integration/#mobile-implementation","title":"Mobile Implementation","text":""},{"location":"backend-integration/#tech-stack","title":"Tech Stack","text":"<ul> <li>Retrofit 2: Type-safe HTTP client.</li> <li>OkHttp 3: Underlying HTTP client with interceptors.</li> <li>Gson: JSON serialization/deserialization.</li> <li>Coroutines: Asynchronous API calls.</li> </ul>"},{"location":"backend-integration/#network-configuration","title":"Network Configuration","text":"<p>The network configuration is centralized in <code>com.example.bhandara.data.api.NetworkModule</code>.</p> <ul> <li>Base URL: Defined in <code>build.gradle.kts</code> as <code>API_BASE_URL</code>.</li> <li>Debug: Defaults to <code>http://192.168.1.5:8080/</code> (Local Network)</li> <li>Release: Should point to production server.</li> <li>Timeouts: 30 seconds for connect, read, and write operations.</li> <li>Logging: <code>HttpLoggingInterceptor</code> is enabled in DEBUG mode (Level: BODY).</li> </ul>"},{"location":"backend-integration/#authentication","title":"Authentication","text":"<p>Security is handled via <code>AuthInterceptor</code>. It automatically retrieves the current Firebase User's ID token and attaches it to every request:</p> <pre><code>Authorization: Bearer &lt;firebase_id_token&gt;\n</code></pre> <p>If the user is not signed in (or <code>signInAnonymously</code> hasn't completed), the request proceeds without the header.</p>"},{"location":"backend-integration/#api-reference","title":"API Reference","text":"<p>The contract is defined in <code>com.example.bhandara.data.api.ApiService</code>.</p>"},{"location":"backend-integration/#1-user-management","title":"1. User Management","text":""},{"location":"backend-integration/#create-user","title":"Create User","text":"<p>Registers a new user (anonymous or authenticated) with the backend.</p> <ul> <li>Endpoint: <code>POST api/users</code></li> <li>Request: <code>CreateUserRequest</code></li> <li><code>uid</code>: Firebase User ID</li> <li><code>fcmToken</code>: Firebase Cloud Messaging token</li> <li><code>latitude</code>: Current latitude</li> <li><code>longitude</code>: Current longitude</li> <li>Response: <code>CreateUserResponse</code></li> </ul>"},{"location":"backend-integration/#update-location","title":"Update Location","text":"<p>Periodically updates the user's location for geo-fencing features.</p> <ul> <li>Endpoint: <code>PUT api/users/location</code></li> <li>Request: <code>UpdateLocationRequest</code></li> <li><code>uid</code>: Firebase User ID</li> <li><code>latitude</code>: New latitude</li> <li><code>longitude</code>: New longitude</li> <li>Response: <code>UpdateLocationResponse</code></li> </ul>"},{"location":"backend-integration/#2-feast-management","title":"2. Feast Management","text":""},{"location":"backend-integration/#report-bhandara-create-feast","title":"Report Bhandara (Create Feast)","text":"<p>Submits a new bhandara event.</p> <ul> <li>Endpoint: <code>POST api/feasts</code></li> <li>Request: <code>FeastRequest</code></li> <li><code>menuItems</code>: List of food items</li> <li><code>startTime</code> / <code>endTime</code>: Event duration</li> <li><code>latitude</code> / <code>longitude</code>: Event location</li> <li><code>imageUrls</code>: List of uploaded image URLs</li> <li>(and other details)</li> <li>Response: <code>FeastResponse</code></li> </ul>"},{"location":"backend-integration/#get-nearby-feasts","title":"Get Nearby Feasts","text":"<p>Retrieves active bhandaras within a specific radius.</p> <ul> <li>Endpoint: <code>GET api/feasts/nearby</code></li> <li>Query Params:</li> <li><code>lat</code>: User's latitude</li> <li><code>lon</code>: User's longitude</li> <li><code>radius</code>: Search radius in meters (default: 500.0)</li> <li>Response: <code>List&lt;FeastResponse&gt;</code></li> </ul>"},{"location":"backend-integration/#backend-requirements-reference","title":"Backend Requirements (Reference)","text":"<p>For the server-side implementation to support this mobile app, the following database structure (using PostgreSQL + PostGIS) is recommended.</p>"},{"location":"backend-integration/#database-schema","title":"Database Schema","text":"<pre><code>CREATE EXTENSION postgis;\n\n-- Users Table\nCREATE TABLE users (\n    uid VARCHAR(128) PRIMARY KEY,\n    fcm_token VARCHAR(512),\n    location GEOGRAPHY(POINT, 4326),\n    last_active TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Feasts Table\nCREATE TABLE feasts (\n    id SERIAL PRIMARY KEY,\n    organizer_uid VARCHAR(128) REFERENCES users(uid),\n    description TEXT,\n    location GEOGRAPHY(POINT, 4326),\n    start_time TIMESTAMP,\n    end_time TIMESTAMP,\n    is_active BOOLEAN DEFAULT TRUE,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE INDEX idx_users_location ON users USING GIST (location);\nCREATE INDEX idx_feasts_location ON feasts USING GIST (location);\n</code></pre>"},{"location":"backend-integration/#api-implementation-notes","title":"API Implementation Notes","text":"<ol> <li>Duplicate Handling: The <code>POST api/users</code> endpoint should handle \"upsert\" logic (insert if new, update if exists).</li> <li>Geo-Queries: Use PostGIS <code>ST_DWithin</code> for the <code>nearby</code> endpoint to efficiently find feasts.</li> <li>Token Validation: The backend must verify the Firebase ID token in the <code>Authorization</code> header using the Firebase Admin SDK.</li> </ol>"},{"location":"development/","title":"Development Guide","text":""},{"location":"development/#development-environment","title":"Development Environment","text":""},{"location":"development/#required-tools","title":"Required Tools","text":"<ul> <li>Android Studio (Arctic Fox or newer)</li> <li>JDK 11+</li> <li>Git</li> <li>Android SDK</li> </ul>"},{"location":"development/#coding-standards","title":"Coding Standards","text":""},{"location":"development/#kotlin-style-guide","title":"Kotlin Style Guide","text":"<p>Follow the official Kotlin coding conventions.</p>"},{"location":"development/#file-organization","title":"File Organization","text":"<ul> <li>One class per file</li> <li>Keep files under 300 lines when possible</li> <li>Group related functionality</li> </ul>"},{"location":"development/#naming-conventions","title":"Naming Conventions","text":"<ul> <li>Classes: PascalCase (<code>MainActivity</code>, <code>UserViewModel</code>)</li> <li>Functions: camelCase (<code>onCreate()</code>, <code>getUserData()</code>)</li> <li>Constants: UPPER_SNAKE_CASE (<code>MAX_COUNT</code>, <code>API_KEY</code>)</li> <li>Variables: camelCase (<code>userName</code>, <code>itemCount</code>)</li> </ul>"},{"location":"development/#git-workflow","title":"Git Workflow","text":""},{"location":"development/#branch-naming","title":"Branch Naming","text":"<ul> <li><code>feature/feature-name</code> - New features</li> <li><code>bugfix/bug-description</code> - Bug fixes</li> <li><code>hotfix/critical-issue</code> - Urgent fixes</li> <li><code>refactor/component-name</code> - Code refactoring</li> </ul>"},{"location":"development/#commit-messages","title":"Commit Messages","text":"<p>Follow conventional commits:</p> <pre><code>feat: add user authentication\nfix: resolve crash on startup\ndocs: update README\nrefactor: simplify data layer\n</code></pre>"},{"location":"development/#building-the-project","title":"Building the Project","text":""},{"location":"development/#debug-build","title":"Debug Build","text":"<pre><code>./gradlew assembleDebug\n</code></pre>"},{"location":"development/#release-build","title":"Release Build","text":"<pre><code>./gradlew assembleRelease\n</code></pre>"},{"location":"development/#testing","title":"Testing","text":""},{"location":"development/#running-tests","title":"Running Tests","text":"<pre><code># Unit tests\n./gradlew test\n\n# Instrumented tests\n./gradlew connectedAndroidTest\n</code></pre>"},{"location":"development/#code-review","title":"Code Review","text":"<ul> <li>All changes require a pull request</li> <li>At least one approval required</li> <li>CI checks must pass</li> </ul>"},{"location":"development/#documentation","title":"Documentation","text":"<ul> <li>Document public APIs with KDoc</li> <li>Update this documentation when adding features</li> <li>Keep README.md up to date</li> </ul>"},{"location":"features/","title":"Features","text":""},{"location":"features/#current-features","title":"Current Features","text":""},{"location":"features/#1-anonymous-onboarding","title":"1. Anonymous Onboarding","text":"<ul> <li>Seamless Entry: Users can start using the app immediately without creating an account.</li> <li>Background Sync: A unique ID is generated and verified with Firebase and the backend silently.</li> </ul>"},{"location":"features/#2-report-bhandara-organizers","title":"2. Report Bhandara (Organizers)","text":"<ul> <li>Easy Submission: A comprehensive form to list a new community feast.</li> <li>Details: Capture essential info like:</li> <li>Menu: List of food items served.</li> <li>Time: Start and end timings.</li> <li>Location: Automatic GPS detection + manual address entry.</li> <li>Photos: Upload proof/ambiance photos directly from camera or gallery.</li> </ul>"},{"location":"features/#3-find-food-hungry-mode","title":"3. Find Food (Hungry Mode)","text":"<ul> <li>Map Interface: View active bhandaras in your vicinity on an interactive Google Map.</li> <li>List View: Browse nearby feasts in a list format.</li> <li>Real-time: See only currently active or upcoming events.</li> </ul>"},{"location":"features/#4-smart-notifications","title":"4. Smart Notifications","text":"<ul> <li>Geo-fenced Alerts: Receive push notifications when a bhandara is reported near your location.</li> <li>Updates: Get notified if event details change.</li> </ul>"},{"location":"features/#5-location-services","title":"5. Location Services","text":"<ul> <li>Live Tracking: Background location updates ensure you get relevant notifications even when the app is minimized (running via WorkManager).</li> </ul>"},{"location":"features/#planned-features","title":"Planned Features","text":"<ul> <li>[ ] Community Ratings: Allow users to rate the quality and hygiene of the food.</li> <li>[ ] Directions: Turn-by-turn navigation to the feast location.</li> <li>[ ] Social Sharing: Share bhandara details on WhatsApp/Social Media.</li> <li>[ ] Organizer Profiles: Allow organizers to build a reputation history.</li> </ul>"},{"location":"features/#user-guide","title":"User Guide","text":""},{"location":"features/#how-to-report-a-bhandara","title":"How to Report a Bhandara","text":"<ol> <li>Open the app and tap on \"Report Bhandara\" on the home screen.</li> <li>Allow Camera and Location permissions if prompted.</li> <li>Capture/Upload Photos of the food or banner.</li> <li>Add Menu Items (type and press enter/comma).</li> <li>Set the Date and Time of the event.</li> <li>Enter Page/Organizer Details.</li> <li>Tap Submit. The feast is now live for others to see!</li> </ol>"},{"location":"features/#how-to-find-food","title":"How to Find Food","text":"<ol> <li>Tap on \"I am Hungry\" on the home screen.</li> <li>View the Map to see pins for nearby food spots.</li> <li>Tap on a Pin to see details (Menu, Time, Distance).</li> </ol>"},{"location":"firebase-setup/","title":"Firebase Setup &amp; User Tracking","text":"<p>This guide explains how the app implements silent user tracking using Firebase Anonymous Authentication, Cloud Messaging (FCM), and location services.</p>"},{"location":"firebase-setup/#overview","title":"Overview","text":"<p>The app automatically tracks users without any login or signup. When a user installs and opens the app:</p> <ol> <li>Anonymous Authentication - Assigns a permanent UID</li> <li>FCM Token - Enables push notifications</li> <li>Location Tracking - Gets user's current location</li> <li>Data Storage - Saves to Firebase Firestore</li> </ol> <p>All of this happens silently in the background without user interaction.</p>"},{"location":"firebase-setup/#architecture","title":"Architecture","text":"<pre><code>App Launch\n    \u2193\nUserManager.initializeUser()\n    \u2193\nFirebase Anonymous Auth \u2192 UID\n    \u2193\nFirebase Messaging \u2192 FCM Token\n    \u2193\nSave to Firestore (uid, fcmToken)\n    \u2193\nRequest Location Permissions\n    \u2193\nGet Location \u2192 Update Firestore\n</code></pre>"},{"location":"firebase-setup/#implementation-details","title":"Implementation Details","text":""},{"location":"firebase-setup/#1-firebase-dependencies","title":"1. Firebase Dependencies","text":"<p>Added to app/build.gradle.kts:</p> <pre><code>// Firebase - Import the BoM\nimplementation(platform(\"com.google.firebase:firebase-bom:34.7.0\"))\n\n// Firebase products\nimplementation(\"com.google.firebase:firebase-analytics\")\nimplementation(\"com.google.firebase:firebase-auth\")           // Anonymous auth\nimplementation(\"com.google.firebase:firebase-firestore\")      // User data storage\nimplementation(\"com.google.firebase:firebase-storage\")        // Photo storage\nimplementation(\"com.google.firebase:firebase-messaging\")      // Push notifications\n\n// Google Play Services for Location\nimplementation(\"com.google.android.gms:play-services-location:21.3.0\")\n\n// Coil for image loading\nimplementation(\"io.coil-kt:coil-compose:2.5.0\")\n</code></pre> <p>Why each dependency: - firebase-auth: Anonymous user authentication - firebase-firestore: Store user data (UID, FCM token, location) - firebase-storage: Future use for feast photos - firebase-messaging: Receive push notifications - play-services-location: Get user's GPS location - coil: Load images efficiently in Compose</p>"},{"location":"firebase-setup/#2-android-manifest-permissions","title":"2. Android Manifest Permissions","text":"<p>Added to AndroidManifest.xml:</p> <pre><code>&lt;!-- Internet permission for Firebase --&gt;\n&lt;uses-permission android:name=\"android.permission.INTERNET\" /&gt;\n\n&lt;!-- Location permissions for tracking user location --&gt;\n&lt;uses-permission android:name=\"android.permission.ACCESS_FINE_LOCATION\" /&gt;\n&lt;uses-permission android:name=\"android.permission.ACCESS_COARSE_LOCATION\" /&gt;\n\n&lt;!-- Notification permission (Android 13+) --&gt;\n&lt;uses-permission android:name=\"android.permission.POST_NOTIFICATIONS\" /&gt;\n</code></pre> <p>Why each permission: - INTERNET: Firebase requires network access - ACCESS_FINE_LOCATION: Get precise GPS coordinates - ACCESS_COARSE_LOCATION: Fallback for approximate location - POST_NOTIFICATIONS: Required for Android 13+ to show notifications</p>"},{"location":"firebase-setup/#3-firebase-cloud-messaging-service","title":"3. Firebase Cloud Messaging Service","text":"<p>Added BhandaraMessagingService.kt:</p> <pre><code>&lt;!-- In AndroidManifest.xml --&gt;\n&lt;service\n    android:name=\".services.BhandaraMessagingService\"\n    android:exported=\"false\"&gt;\n    &lt;intent-filter&gt;\n        &lt;action android:name=\"com.google.firebase.MESSAGING_EVENT\" /&gt;\n    &lt;/intent-filter&gt;\n&lt;/service&gt;\n</code></pre> <p>Purpose: - Receives push notifications from Firebase - Displays notifications in system tray - Handles notification clicks to open the app</p> <p>How it works: 1. Backend sends FCM notification 2. Firebase delivers to device 3. Service receives message 4. Creates and displays notification</p>"},{"location":"firebase-setup/#components","title":"Components","text":""},{"location":"firebase-setup/#usermanager","title":"UserManager","text":"<p>Location: UserManager.kt</p> <p>Responsible for: - Initializing anonymous users - Managing FCM tokens - Updating user locations - (Future) Syncing data to backend API</p> <p>Key Methods: - <code>initializeUser()</code>: Signs in anonymously and saves to Firestore - <code>updateUserLocation()</code>: Gets GPS and updates Firestore</p>"},{"location":"firebase-setup/#userrepository","title":"UserRepository","text":"<p>Location: UserRepository.kt</p> <p>Handles Firebase operations: - <code>signInAnonymously()</code>: Creates anonymous Firebase user - <code>getFcmToken()</code>: Retrieves FCM device token - <code>saveUser()</code>: Saves user data to Firestore - <code>updateUserLocation()</code>: Updates location in Firestore</p>"},{"location":"firebase-setup/#locationhelper","title":"LocationHelper","text":"<p>Location: LocationHelper.kt</p> <p>Manages location services: - <code>hasLocationPermissions()</code>: Checks if permissions granted - <code>getCurrentLocation()</code>: Gets precise GPS coordinates - <code>getLastKnownLocation()</code>: Gets cached location (faster)</p>"},{"location":"firebase-setup/#data-models","title":"Data Models","text":"<p>User Model - User.kt:</p> <pre><code>data class User(\n    val uid: String = \"\",\n    val fcmToken: String = \"\",\n    val location: GeoPoint? = null,\n    val createdAt: Long = System.currentTimeMillis(),\n    val lastActive: Long = System.currentTimeMillis()\n)\n</code></pre>"},{"location":"firebase-setup/#user-flow","title":"User Flow","text":""},{"location":"firebase-setup/#first-app-launch","title":"First App Launch","text":"<ol> <li>App Opens \u2192 <code>MainActivity.onCreate()</code></li> <li>UserManager Initialized \u2192 Creates UserManager instance</li> <li> <p>initializeUser() Called:    <pre><code>// Step 1: Anonymous sign in\nval uid = userRepository.signInAnonymously() // e.g., \"abc123def456\"\n\n// Step 2: Get FCM token\nval fcmToken = userRepository.getFcmToken() // e.g., \"fcm_device_token_...\"\n\n// Step 3: Save to Firestore\nuserRepository.saveUser(uid, fcmToken)\n</code></pre></p> </li> <li> <p>Permissions Requested \u2192 Location and notifications</p> </li> <li>Location Updated (if granted):    <pre><code>val location = locationHelper.getCurrentLocation()\nuserRepository.updateUserLocation(uid, location)\n</code></pre></li> </ol>"},{"location":"firebase-setup/#subsequent-app-launches","title":"Subsequent App Launches","text":"<ol> <li>App Opens</li> <li>Existing User Check \u2192 Firebase recognizes returning user</li> <li>Same UID Used \u2192 No new user created</li> <li>FCM Token Verified \u2192 Updated if changed</li> <li>Location Updated \u2192 Fresh GPS coordinates</li> </ol>"},{"location":"firebase-setup/#firebase-console-verification","title":"Firebase Console Verification","text":""},{"location":"firebase-setup/#authentication","title":"Authentication","text":"<ol> <li>Go to Firebase Console</li> <li>Select \"bhandara\" project</li> <li>Navigate to Authentication \u2192 Users</li> <li>See anonymous users with UID</li> </ol>"},{"location":"firebase-setup/#firestore-database","title":"Firestore Database","text":"<ol> <li>In Firebase Console</li> <li>Navigate to Firestore Database</li> <li>Open users collection</li> <li>View documents with structure:    <pre><code>users/\n  {uid}/\n    - uid: \"abc123def456\"\n    - fcmToken: \"fcm_token_...\"\n    - location: GeoPoint(18.5823749, 73.8844745)\n    - createdAt: 1704045600000\n    - lastActive: 1704045600000\n</code></pre></li> </ol>"},{"location":"firebase-setup/#cloud-messaging","title":"Cloud Messaging","text":"<ol> <li>In Firebase Console</li> <li>Navigate to Cloud Messaging</li> <li>View registered FCM tokens</li> <li>Test notifications from console</li> </ol>"},{"location":"firebase-setup/#debugging","title":"Debugging","text":""},{"location":"firebase-setup/#logcat-tags","title":"LogCat Tags","text":"<p>Monitor these tags in Android Studio Logcat:</p> <ul> <li><code>UserManager</code>: User initialization flow</li> <li><code>UserRepository</code>: Firebase operations</li> <li><code>LocationHelper</code>: Location updates</li> <li><code>BhandaraMessaging</code>: Notification handling</li> </ul>"},{"location":"firebase-setup/#expected-log-sequence","title":"Expected Log Sequence","text":"<pre><code>UserManager: User signed in with UID: abc123def456\nUserManager: FCM token obtained\nUserRepository: User data saved successfully\nUserManager: User saved to Firestore\nLocationHelper: Location obtained: 18.5823749, 73.8844745\nUserRepository: User location updated\nUserManager: User location updated in Firestore\n</code></pre>"},{"location":"firebase-setup/#common-issues","title":"Common Issues","text":""},{"location":"firebase-setup/#location-not-updating","title":"Location Not Updating","text":"<p>Problem: Location stays null in Firestore</p> <p>Solutions: - Check permissions granted - Ensure emulator has location set (Extended Controls \u2192 Location) - Use device with GPS instead of emulator - Check Play Services installed on emulator</p>"},{"location":"firebase-setup/#fcm-token-not-generated","title":"FCM Token Not Generated","text":"<p>Problem: fcmToken is empty</p> <p>Solutions: - Use emulator with Google Play (not just Google APIs) - Check <code>google-services.json</code> is valid - Verify internet connection - Restart app</p>"},{"location":"firebase-setup/#anonymous-user-not-created","title":"Anonymous User Not Created","text":"<p>Problem: UID is null</p> <p>Solutions: - Check Firebase Authentication is enabled - Verify <code>google-services.json</code> configuration - Enable Anonymous sign-in in Firebase Console</p>"},{"location":"firebase-setup/#security-considerations","title":"Security Considerations","text":""},{"location":"firebase-setup/#anonymous-auth-limitations","title":"Anonymous Auth Limitations","text":"<ul> <li>Device-specific: UID tied to app installation</li> <li>Non-recoverable: Uninstall = new user</li> <li>No cross-device: Can't sync across devices</li> </ul>"},{"location":"firebase-setup/#privacy","title":"Privacy","text":"<ul> <li>No personal information collected</li> <li>Only: UID, FCM token, location</li> <li>Users can't be identified</li> <li>Complies with anonymous usage</li> </ul>"},{"location":"firebase-setup/#data-retention","title":"Data Retention","text":"<p>Consider implementing: - Remove users inactive for 90+ days - Clear location data older than 30 days - GDPR compliance for EU users</p>"},{"location":"firebase-setup/#next-steps","title":"Next Steps","text":"<p>See Backend Integration for: - Syncing user data to PostgreSQL/PostGIS - Implementing backend API calls - Querying nearby users - Sending targeted notifications</p>"},{"location":"firebase-setup/#related-documentation","title":"Related Documentation","text":"<ul> <li>Getting Started - Initial setup</li> <li>Architecture - Overall app structure</li> <li>Backend Integration - API implementation</li> <li>Development Guide - Best practices</li> </ul>"},{"location":"getting-started/","title":"Getting Started","text":""},{"location":"getting-started/#prerequisites","title":"Prerequisites","text":"<ul> <li>Android Studio (latest version)</li> <li>JDK 11 or higher</li> <li>Android SDK</li> <li>Git</li> </ul>"},{"location":"getting-started/#installation","title":"Installation","text":""},{"location":"getting-started/#1-clone-the-repository","title":"1. Clone the Repository","text":"<pre><code>git clone https://github.com/piyushchouhan/bhandara.git\ncd bhandara\n</code></pre>"},{"location":"getting-started/#2-open-in-android-studio","title":"2. Open in Android Studio","text":"<ol> <li>Launch Android Studio</li> <li>Select \"Open an Existing Project\"</li> <li>Navigate to the cloned repository</li> <li>Click \"OK\"</li> </ol>"},{"location":"getting-started/#3-sync-gradle","title":"3. Sync Gradle","text":"<p>Android Studio will automatically sync Gradle. If not:</p> <ol> <li>Click on \"File\" \u2192 \"Sync Project with Gradle Files\"</li> <li>Wait for the sync to complete</li> </ol>"},{"location":"getting-started/#4-run-the-application","title":"4. Run the Application","text":"<ol> <li>Connect an Android device or start an emulator</li> <li>Click the \"Run\" button (\u25b6\ufe0f) in Android Studio</li> <li>Select your target device</li> <li>Wait for the app to build and install</li> </ol>"},{"location":"getting-started/#configuration","title":"Configuration","text":""},{"location":"getting-started/#google-services","title":"Google Services","text":"<p>The project uses Firebase. Ensure you have:</p> <ul> <li>Valid <code>google-services.json</code> in the <code>app/</code> directory</li> <li>Firebase project configured properly</li> </ul>"},{"location":"getting-started/#local-properties","title":"Local Properties","text":"<p>Check <code>local.properties</code> for SDK paths:</p> <pre><code>sdk.dir=/path/to/Android/sdk\n</code></pre>"},{"location":"getting-started/#troubleshooting","title":"Troubleshooting","text":""},{"location":"getting-started/#build-failures","title":"Build Failures","text":"<ul> <li>Clean the project: <code>Build \u2192 Clean Project</code></li> <li>Rebuild: <code>Build \u2192 Rebuild Project</code></li> <li>Invalidate caches: <code>File \u2192 Invalidate Caches / Restart</code></li> </ul>"},{"location":"getting-started/#gradle-issues","title":"Gradle Issues","text":"<pre><code>./gradlew clean\n./gradlew build\n</code></pre>"}]}